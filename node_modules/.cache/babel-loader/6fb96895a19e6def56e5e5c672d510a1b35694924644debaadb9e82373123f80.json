{"ast":null,"code":"import * as React from 'react';\nimport { useThree, useFrame, createPortal } from '@react-three/fiber';\nimport { Object3D, Matrix4, Quaternion, Vector3, Scene } from 'three';\nimport { OrthographicCamera } from './OrthographicCamera.js';\nimport { useCamera } from './useCamera.js';\nconst Context = /*#__PURE__*/React.createContext({});\nconst useGizmoContext = () => {\n  return React.useContext(Context);\n};\nconst turnRate = 2 * Math.PI; // turn rate in angles per second\n\nconst dummy = new Object3D();\nconst matrix = new Matrix4();\nconst [q1, q2] = [new Quaternion(), new Quaternion()];\nconst target = new Vector3();\nconst targetPosition = new Vector3();\nconst GizmoHelper = _ref => {\n  let {\n    alignment = 'bottom-right',\n    margin = [80, 80],\n    renderPriority = 0,\n    autoClear = true,\n    onUpdate,\n    onTarget,\n    children: GizmoHelperComponent\n  } = _ref;\n  const size = useThree(_ref2 => {\n    let {\n      size\n    } = _ref2;\n    return size;\n  });\n  const mainCamera = useThree(_ref3 => {\n    let {\n      camera\n    } = _ref3;\n    return camera;\n  }); // @ts-expect-error new in @react-three/fiber@7.0.5\n\n  const defaultControls = useThree(_ref4 => {\n    let {\n      controls\n    } = _ref4;\n    return controls;\n  });\n  const gl = useThree(_ref5 => {\n    let {\n      gl\n    } = _ref5;\n    return gl;\n  });\n  const scene = useThree(_ref6 => {\n    let {\n      scene\n    } = _ref6;\n    return scene;\n  });\n  const invalidate = useThree(_ref7 => {\n    let {\n      invalidate\n    } = _ref7;\n    return invalidate;\n  });\n  const backgroundRef = React.useRef();\n  const gizmoRef = React.useRef();\n  const virtualCam = React.useRef(null);\n  const [virtualScene] = React.useState(() => new Scene());\n  const animating = React.useRef(false);\n  const radius = React.useRef(0);\n  const focusPoint = React.useRef(new Vector3(0, 0, 0));\n  const tweenCamera = React.useCallback(direction => {\n    animating.current = true;\n    if (defaultControls || onTarget) focusPoint.current = (defaultControls == null ? void 0 : defaultControls.target) || (onTarget == null ? void 0 : onTarget());\n    radius.current = mainCamera.position.distanceTo(target); // Rotate from current camera orientation\n\n    q1.copy(mainCamera.quaternion); // To new current camera orientation\n\n    targetPosition.copy(direction).multiplyScalar(radius.current).add(target);\n    dummy.lookAt(targetPosition);\n    q2.copy(dummy.quaternion);\n    invalidate();\n  }, [defaultControls, mainCamera, onTarget, invalidate]);\n  React.useEffect(() => {\n    if (scene.background) {\n      //Interchange the actual scene background with the virtual scene\n      backgroundRef.current = scene.background;\n      scene.background = null;\n      virtualScene.background = backgroundRef.current;\n    }\n    return () => {\n      // reset on unmount\n      if (backgroundRef.current) scene.background = backgroundRef.current;\n    };\n  }, []);\n  useFrame((_, delta) => {\n    if (virtualCam.current && gizmoRef.current) {\n      var _gizmoRef$current;\n\n      // Animate step\n      if (animating.current) {\n        if (q1.angleTo(q2) < 0.01) {\n          animating.current = false;\n        } else {\n          const step = delta * turnRate; // animate position by doing a slerp and then scaling the position on the unit sphere\n\n          q1.rotateTowards(q2, step); // animate orientation\n\n          mainCamera.position.set(0, 0, 1).applyQuaternion(q1).multiplyScalar(radius.current).add(focusPoint.current);\n          mainCamera.up.set(0, 1, 0).applyQuaternion(q1).normalize();\n          mainCamera.quaternion.copy(q1);\n          if (onUpdate) onUpdate();else if (defaultControls) defaultControls.update();\n          invalidate();\n        }\n      } // Sync Gizmo with main camera orientation\n\n      matrix.copy(mainCamera.matrix).invert();\n      (_gizmoRef$current = gizmoRef.current) == null ? void 0 : _gizmoRef$current.quaternion.setFromRotationMatrix(matrix); // Render virtual camera\n\n      if (autoClear) gl.autoClear = false;\n      gl.clearDepth();\n      gl.render(virtualScene, virtualCam.current);\n    }\n  }, renderPriority);\n  const raycast = useCamera(virtualCam);\n  const gizmoHelperContext = React.useMemo(() => ({\n    tweenCamera,\n    raycast\n  }), [tweenCamera]); // Position gizmo component within scene\n\n  const [marginX, marginY] = margin;\n  const x = alignment.endsWith('-left') ? -size.width / 2 + marginX : size.width / 2 - marginX;\n  const y = alignment.startsWith('top-') ? size.height / 2 - marginY : -size.height / 2 + marginY;\n  return createPortal(/*#__PURE__*/React.createElement(Context.Provider, {\n    value: gizmoHelperContext\n  }, /*#__PURE__*/React.createElement(OrthographicCamera, {\n    ref: virtualCam,\n    position: [0, 0, 200]\n  }), /*#__PURE__*/React.createElement(\"group\", {\n    ref: gizmoRef,\n    position: [x, y, 0]\n  }, GizmoHelperComponent)), virtualScene);\n};\nexport { GizmoHelper, useGizmoContext };","map":{"version":3,"names":["React","useThree","useFrame","createPortal","Object3D","Matrix4","Quaternion","Vector3","Scene","OrthographicCamera","useCamera","Context","createContext","useGizmoContext","useContext","turnRate","Math","PI","dummy","matrix","q1","q2","target","targetPosition","GizmoHelper","_ref","alignment","margin","renderPriority","autoClear","onUpdate","onTarget","children","GizmoHelperComponent","size","_ref2","mainCamera","_ref3","camera","defaultControls","_ref4","controls","gl","_ref5","scene","_ref6","invalidate","_ref7","backgroundRef","useRef","gizmoRef","virtualCam","virtualScene","useState","animating","radius","focusPoint","tweenCamera","useCallback","direction","current","position","distanceTo","copy","quaternion","multiplyScalar","add","lookAt","useEffect","background","_","delta","_gizmoRef$current","angleTo","step","rotateTowards","set","applyQuaternion","up","normalize","update","invert","setFromRotationMatrix","clearDepth","render","raycast","gizmoHelperContext","useMemo","marginX","marginY","x","endsWith","width","y","startsWith","height","createElement","Provider","value","ref"],"sources":["/home/nadaabuissa/Downloads/Computer/node_modules/@react-three/drei/core/GizmoHelper.js"],"sourcesContent":["import * as React from 'react';\nimport { useThree, useFrame, createPortal } from '@react-three/fiber';\nimport { Object3D, Matrix4, Quaternion, Vector3, Scene } from 'three';\nimport { OrthographicCamera } from './OrthographicCamera.js';\nimport { useCamera } from './useCamera.js';\n\nconst Context = /*#__PURE__*/React.createContext({});\nconst useGizmoContext = () => {\n  return React.useContext(Context);\n};\nconst turnRate = 2 * Math.PI; // turn rate in angles per second\n\nconst dummy = new Object3D();\nconst matrix = new Matrix4();\nconst [q1, q2] = [new Quaternion(), new Quaternion()];\nconst target = new Vector3();\nconst targetPosition = new Vector3();\nconst GizmoHelper = ({\n  alignment = 'bottom-right',\n  margin = [80, 80],\n  renderPriority = 0,\n  autoClear = true,\n  onUpdate,\n  onTarget,\n  children: GizmoHelperComponent\n}) => {\n  const size = useThree(({\n    size\n  }) => size);\n  const mainCamera = useThree(({\n    camera\n  }) => camera); // @ts-expect-error new in @react-three/fiber@7.0.5\n\n  const defaultControls = useThree(({\n    controls\n  }) => controls);\n  const gl = useThree(({\n    gl\n  }) => gl);\n  const scene = useThree(({\n    scene\n  }) => scene);\n  const invalidate = useThree(({\n    invalidate\n  }) => invalidate);\n  const backgroundRef = React.useRef();\n  const gizmoRef = React.useRef();\n  const virtualCam = React.useRef(null);\n  const [virtualScene] = React.useState(() => new Scene());\n  const animating = React.useRef(false);\n  const radius = React.useRef(0);\n  const focusPoint = React.useRef(new Vector3(0, 0, 0));\n  const tweenCamera = React.useCallback(direction => {\n    animating.current = true;\n    if (defaultControls || onTarget) focusPoint.current = (defaultControls == null ? void 0 : defaultControls.target) || (onTarget == null ? void 0 : onTarget());\n    radius.current = mainCamera.position.distanceTo(target); // Rotate from current camera orientation\n\n    q1.copy(mainCamera.quaternion); // To new current camera orientation\n\n    targetPosition.copy(direction).multiplyScalar(radius.current).add(target);\n    dummy.lookAt(targetPosition);\n    q2.copy(dummy.quaternion);\n    invalidate();\n  }, [defaultControls, mainCamera, onTarget, invalidate]);\n  React.useEffect(() => {\n    if (scene.background) {\n      //Interchange the actual scene background with the virtual scene\n      backgroundRef.current = scene.background;\n      scene.background = null;\n      virtualScene.background = backgroundRef.current;\n    }\n\n    return () => {\n      // reset on unmount\n      if (backgroundRef.current) scene.background = backgroundRef.current;\n    };\n  }, []);\n  useFrame((_, delta) => {\n    if (virtualCam.current && gizmoRef.current) {\n      var _gizmoRef$current;\n\n      // Animate step\n      if (animating.current) {\n        if (q1.angleTo(q2) < 0.01) {\n          animating.current = false;\n        } else {\n          const step = delta * turnRate; // animate position by doing a slerp and then scaling the position on the unit sphere\n\n          q1.rotateTowards(q2, step); // animate orientation\n\n          mainCamera.position.set(0, 0, 1).applyQuaternion(q1).multiplyScalar(radius.current).add(focusPoint.current);\n          mainCamera.up.set(0, 1, 0).applyQuaternion(q1).normalize();\n          mainCamera.quaternion.copy(q1);\n          if (onUpdate) onUpdate();else if (defaultControls) defaultControls.update();\n          invalidate();\n        }\n      } // Sync Gizmo with main camera orientation\n\n\n      matrix.copy(mainCamera.matrix).invert();\n      (_gizmoRef$current = gizmoRef.current) == null ? void 0 : _gizmoRef$current.quaternion.setFromRotationMatrix(matrix); // Render virtual camera\n\n      if (autoClear) gl.autoClear = false;\n      gl.clearDepth();\n      gl.render(virtualScene, virtualCam.current);\n    }\n  }, renderPriority);\n  const raycast = useCamera(virtualCam);\n  const gizmoHelperContext = React.useMemo(() => ({\n    tweenCamera,\n    raycast\n  }), [tweenCamera]); // Position gizmo component within scene\n\n  const [marginX, marginY] = margin;\n  const x = alignment.endsWith('-left') ? -size.width / 2 + marginX : size.width / 2 - marginX;\n  const y = alignment.startsWith('top-') ? size.height / 2 - marginY : -size.height / 2 + marginY;\n  return createPortal( /*#__PURE__*/React.createElement(Context.Provider, {\n    value: gizmoHelperContext\n  }, /*#__PURE__*/React.createElement(OrthographicCamera, {\n    ref: virtualCam,\n    position: [0, 0, 200]\n  }), /*#__PURE__*/React.createElement(\"group\", {\n    ref: gizmoRef,\n    position: [x, y, 0]\n  }, GizmoHelperComponent)), virtualScene);\n};\n\nexport { GizmoHelper, useGizmoContext };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}